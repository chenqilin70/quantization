<?xml version="1.0" encoding="UTF-8"?>
<sqls>
    <!--各大index的相关系数排列组合-->
    <corr_index>
        <![CDATA[
            select
                regexp_replace(a.key,'_.+','') as index1,regexp_replace(b.key,'_.+','') as index2,corr(cast(a.close as decimal(26,8)) , cast(b.close as decimal(26,8)) ) as corrratio
            from
                fund_catcher.index a
                inner join fund_catcher.index b on regexp_replace(a.key,'.+_','')=regexp_replace(b.key,'.+_','')
            where
                regexp_replace(a.key,'_.+','')>regexp_replace(b.key,'_.+','')
            group by
                regexp_replace(a.key,'_.+',''),regexp_replace(b.key,'_.+','')
        ]]>
    </corr_index>
</sqls>
