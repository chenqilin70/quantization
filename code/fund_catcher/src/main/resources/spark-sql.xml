<?xml version="1.0" encoding="UTF-8"?>
<sqls>
    <test>
        <![CDATA[
            select
                corr(i.close,n.LJJZ) as correlationindex,substring_index(n.rowkey,"_",1) as fundcode,regexp_replace(regexp_replace(f.fxrq,'年|月','-'),'日','')
            from
                index i
                inner join netval n on substr(i.rowkey,instr(i.rowkey,"_")+1)=substr(n.rowkey,instr(n.rowkey,"_")+1)
                inner join fund f on f.fundcode=substr(n.rowkey,1,instr(n.rowkey,"_")-1)
            where
                i.close is not null
                and n.LJJZ is not null
                and f.jjlx='股票型'
                and f.fxrq is not null
                and add_months(now(),0-(1*12)) >= to_date(regexp_replace(regexp_replace(f.fxrq,'年|月','-'),'日',''))

            group by
                substring_index(n.rowkey,"_",1),f.fxrq
            order by
                correlationindex
        ]]>
    </test>
    <test2>
        <![CDATA[


            select
                substr('000001_20011218',1,instr('000001_20011218',"_"))

            from
                fund




        ]]>
    </test2>
    <index>
        <![CDATA[
            select * from index
        ]]>
    </index>

</sqls>